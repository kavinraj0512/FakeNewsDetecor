# Import necessary libraries import pandas as pd
import numpy as np
from sklearn.model_selection import train_test_split
from sklearn.feature_extraction.text import TfidfVectorizer from sklearn.linear_model import PassiveAggressiveClassifier
from sklearn.metrics import accuracy_score, confusion_matrix, classification_report
import re import string

# Step 1: Load the Dataset df = pd.read_csv('news.csv')

print("Dataset Shape:", df.shape) print("\nFirst few rows:") print(df.head())

# Check for missing values print("\nMissing values:") print(df.isnull().sum())

# Check label distribution print("\nLabel distribution:") print(df['label'].value_counts())

# Step 2: Data Preprocessing def preprocess_text(text):
"""Clean and preprocess the text data"""
# Convert to lowercase text = text.lower()

# Remove URLs
text = re.sub(r'http\S+|www\S+|https\S+', '', text, flags=re.MULTILINE)

# Remove user mentions and hashtags text = re.sub(r'\@\w+|\#', '', text)

# Remove punctuation
text = text.translate(str.maketrans('', '', string.punctuation))

# Remove extra whitespace
text = re.sub(r'\s+', ' ', text).strip() return text
# Apply preprocessing
df['text'] = df['text'].apply(preprocess_text)

# Remove any rows with empty text after preprocessing df = df[df['text'].str.strip() != '']

print("\nAfter preprocessing:") print(df.head())

# Step 3: Split the data
X = df['text']
y = df['label']

X_train, X_test, y_train, y_test = train_test_split( X, y, test_size=0.2, random_state=42, stratify=y
)
print(f"\nTraining set size: {len(X_train)}") print(f"Testing set size: {len(X_test)}")

# Step 4: TF-IDF Vectorization tfidf_vectorizer = TfidfVectorizer(
max_features=5000,	# Use top 5000 features
stop_words='english',		# Remove common English stop words max_df=0.7,	# Ignore terms that appear in >70% of documents min_df=5	# Ignore terms that appear in <5 documents
)

# Fit and transform training data
X_train_tfidf = tfidf_vectorizer.fit_transform(X_train)

# Transform test data
X_test_tfidf = tfidf_vectorizer.transform(X_test)
print(f"\nTF-IDF Feature Matrix Shape: {X_train_tfidf.shape}") # Step 5: Train Passive Aggressive Classifier
pac = PassiveAggressiveClassifier(
max_iter=50,	# Maximum number of passes over training data random_state=42,
C=0.5	# Regularization parameter
)

# Train the model print("\nTraining the model...") pac.fit(X_train_tfidf, y_train) print("Training completed!")

# Step 6: Make Predictions
y_pred = pac.predict(X_test_tfidf)

# Step 7: Evaluate the Model # Calculate accuracy
accuracy = accuracy_score(y_test, y_pred)
print(f"\nAccuracy: {accuracy * 100:.2f}%")

# Confusion Matrix
conf_matrix = confusion_matrix(y_test, y_pred) print("\nConfusion Matrix:") print(conf_matrix)

# Classification Report print("\nClassification Report:") print(classification_report(y_test, y_pred))

# Step 8: Function to predict new articles def predict_news(news_text):
"""Predict whether a news article is REAL or FAKE"""
# Preprocess the text
cleaned_text = preprocess_text(news_text)

# Vectorize
text_tfidf = tfidf_vectorizer.transform([cleaned_text])

# Predict
prediction = pac.predict(text_tfidf)[0]

# Get prediction probability (decision function) confidence = pac.decision_function(text_tfidf)[0]

return prediction, confidence # Step 9: Test with sample news
 
 
 
